# git
## 最佳实践
- git管理的项目`一定要写.gitignore文件`
- 到工位第一件事是 `git fetch origin` ，或者配置自动定期刷新
## 核心概念
`工作区` -- add -- `暂存区` -- commit -- `本地提交（版本库）`-- push -- `远程版本库`

- 工作区和暂存区是纯粹的本地概念，他们独立于任何分支
	- 工作区就是硬盘上的文件，即文件本身的样子
- 提交的东西/快照才会存储到版本库
- `分支`是指向提交快照的指针，分支存在于版本库。
	- `标签tag` 也是指向提交快照的指针/别名；是一个**静止**的指针，用于标记**标记重要的里程碑**，如版本。
	- `分支`是一个**可移动**的指针，代表一条**开发线**。
- `HEAD` 是当前工作目录所对应的「快照」的指针。它指向正在基于哪个提交进行工作。
	- `HEAD` 通常是一个「符号引用」**：在大多数情况下，`HEAD` 并不直接指向一个提交哈希，而是**指向一个分支（例如 `ref: refs/heads/main`）。
	- 分支再指向提交：这个分支（如 `main`）才真正指向最新的提交。所以，`HEAD` -> `main` -> `commit-id`。这意味着你“位于” `main` 分支上。
	- `分离头指针`状态（Detached HEAD）**：当直接检出一个提交哈希或标签（而不是分支名）时，`HEAD` 会**直接指向那个提交，而不是任何分支。在这种状态下，新提交将没有分支来“承载”，很容易丢失，所以通常只用于临时查看历史。
- `origin/dev`  VS  `origin dev`
	- origin/dev 即`远程跟踪分支`，是本地存在的、只读的远程分支引用/指针，指向远程仓库 `origin` 上 `dev` 分支**最后一次被拉取到本地时的状态**。
	- origin dev 是`git` 命令的参数，传递两个参数，分别指仓库和分支。一般这种命令行工具，空格出来的都是独立的参数。
- `.git` 隐藏文件夹是 Git 的“控制中心”。
	- 所有 Git 命令都需要读取这个目录来获取仓库信息（如提交历史、分支、配置等），并将新的更改（如新的提交）写入这个目录。
	-  每个拥有自己 `.git` 文件夹的目录都是一个**独立的 Git 仓库**。Git 命令在这个仓库中运行时都是独立隔离的。

## 常用命令

### 一、Git 基础操作

#### 1. 初始化仓库

```
git init
```

**解释**：

- 在当前目录创建一个新的 Git 本地仓库，生成 `.git` 目录，存储所有的 Git 元数据和对象，开始对该目录下的项目进行版本控制。

  

#### 2. 克隆仓库

```
git clone <repository_url>
```

**解释**：

- 从远程仓库地址 `<repository_url>` 克隆一个仓库到本地，会自动创建一个与远程仓库同名的目录，并将远程仓库的所有文件和历史信息复制到本地。

  

#### 3. 查看状态

```
git status
```

**解释**：

- 查看当前工作目录和暂存区的状态，显示哪些文件被修改、哪些文件被添加到暂存区、哪些文件未被跟踪等信息，帮助你了解当前 Git 状态。

  

#### 4. 添加修改

```
git add <file>
git add.
```

**解释**：

- `git add <file>` 用于将指定文件 `<file>` 的修改添加到暂存区。
- `git add.` 会将当前目录下的所有修改添加到暂存区，包括新文件、修改的文件和删除的文件，准备提交。

  

#### 5. 提交修改

```
git commit -m "提交消息"
```

**解释**：

- 将暂存区的修改提交到本地仓库，创建一个新的提交，`-m` 选项用于添加提交消息，描述本次提交的内容。

  

#### 6. 查看提交历史

```
git log
git log --oneline
git log --graph
git log -n <number>
```

**解释**：

- `git log` 显示当前分支的详细提交历史，包括提交的 `SHA-1` 哈希值、作者、日期和提交消息。
- `git log --oneline` 以简洁的方式显示提交历史，只显示 `SHA-1` 的前 7 个字符和提交消息，适合快速查看。
- `git log --graph` 以图形化的方式显示提交历史，对于查看分支和合并历史非常有用。
- `git log -n <number>` 显示最近的 `<number>` 个提交。

### 二、分支操作

#### 1. 创建分支

```
git checkout -b <branch_name>
```

**解释**：

- 创建一个名为 `<branch_name>` 的新分支，并将 `HEAD` 指针切换到该分支，方便进行新功能开发或 bug 修复。

  

#### 2. 切换分支

```
git checkout <branch_name>
```

**解释**：

- 将 `HEAD` 指针切换到 `<branch_name>` 分支，你将在该分支上进行后续的操作，如提交、修改等。

  

#### 3. 查看分支

```
git branch
```

**解释**：

- 列出本地的所有分支，当前分支会以 `*` 标记，显示 `HEAD` 的位置。

  

#### 4. 合并分支

```
git merge <branch_name>
git merge --no-ff <branch_name>
```

**解释**：

- `git merge <branch_name>` 会将 `<branch_name>` 分支的修改合并到当前分支。
- `git merge --no-ff <branch_name>` 会创建一个合并提交，即使可以进行快速合并也会强制创建，保留合并的历史记录。

  

#### 5. 变基操作

```
git rebase <branch_name>
```

**解释**：

- 将当前分支的提交应用到 `<branch_name>` 分支的最新提交之后，使当前分支的提交看起来像是在 `<branch_name>` 分支的最新提交之后顺序开发的，会重写提交历史。

### 三、远程操作


#### 1. 添加远程仓库

```
# 查看当前已配置的远程仓库
git remote -v

git remote add origin <repository_url>
```

**解释**：

- 将远程仓库地址 `<repository_url>` 添加到本地仓库，并命名为 `origin`，方便后续的拉取和推送操作。

如果是fork开源项目，最好再添加远程上游项目

```
git remote add upstream <repository_url>
```

验证设置

```
git remote -v
# 输出应显示：
# origin  https://github.com/YOUR_USERNAME/project.git (fetch/push)
# upstream https://github.com/ORIGINAL_OWNER/project.git (fetch)

git fetch # 会同时拉取origin 和 upstream 的更新
```

#### 2. 拉取更新

```
git fetch origin
```

**解释**：

- 从远程仓库 `origin` 拉取最新的信息，更新本地存储的远程分支，包括 `origin/<branch>` 等远程跟踪分支，使本地存储的远程分支信息与远程仓库保持同步。

  

#### 3. 拉取并合并

```
git pull origin <branch_name>
```

**解释**：

- 相当于 `git fetch origin <branch_name>` 与 `git merge origin/<branch_name>` 的组合操作，从远程 `branch_name` 分支拉取更新并合并到当前分支。

  

#### 4. 推送更新

```
git push -u origin feature/add-run-params
// 新分支使用 -u 设置远程上游分支，后续push无需指定仓库和分支

git push origin <branch_name>
git push --force
git push --force-with-lease
```

**解释**：

- `git push origin <branch_name>` 将当前分支的更新推送到远程 `origin` 仓库的 `<branch_name>` 分支。
- `git push --force` 是强制推送，会覆盖远程分支的历史，在团队协作中要谨慎使用，可能会导致其他成员的工作丢失。
- `git push --force-with-lease` 是更安全的强制推送，会检查远程分支是否有新的提交，如果没有才会推送，避免意外覆盖他人的工作。

### 四、标签操作

#### 1. 创建标签

```
git tag <tag_name>
git tag -a <tag_name> -m "标签消息"
```

**解释**：

- `git tag <tag_name>` 创建一个轻量级标签，只是一个指向某个提交的指针。
- `git tag -a <tag_name> -m "标签消息"` 创建一个带注释的标签，包含创建者、日期和消息。

  

#### 2. 查看标签

```
git tag
```

**解释**：

- 列出所有的标签。

  

#### 3. 推送标签

```
git push origin <tag_name>
git push origin --tags
```

**解释**：

- `git push origin <tag_name>` 将指定标签推送到远程仓库。
- `git push origin --tags` 会将所有的本地标签推送到远程仓库。

### 五、暂存操作

#### 1. 存储修改

```
git stash save "描述信息"
```

**解释**：

- 将当前工作目录和暂存区的修改存储到一个本地存储区（stash），方便在不提交的情况下切换分支或处理其他工作，可添加描述信息。

  

#### 2. 查看存储列表

```
git stash list
```

**解释**：

- 列出所有存储的修改，以 `stash@{n}` 的形式表示，`n` 表示存储的顺序，方便查看存储的修改及其描述。

  

#### 3. 应用存储的修改

```
git stash apply
git stash apply stash@{n}
```

**解释**：

- `git stash apply` 会将最近存储的修改应用到当前工作目录和暂存区，但不会从存储列表中删除。
- `git stash apply stash@{n}` 可以将指定的存储修改（`stash@{n}`）应用到当前工作目录和暂存区。

  

#### 4. 恢复并删除存储的修改

```
git stash pop
git stash pop stash@{n}
```

**解释**：

- `git stash pop` 将最近存储的修改应用到当前工作目录和暂存区，并从存储列表中删除该修改。
- `git stash pop stash@{n}` 对指定的存储修改进行恢复并删除操作。

  

#### 5. 删除存储的修改

```
git stash drop
git stash drop stash@{n}
git stash clear
```

**解释**：

- `git stash drop` 删除最近存储的修改。
- `git stash drop stash@{n}` 删除指定的存储修改。
- `git stash clear` 清空整个存储列表。

### 六、其他操作

#### 1. 查看操作记录

```
git reflog
```

**解释**：

- 记录了本地仓库中 `HEAD` 和分支引用的更新操作，包括提交、重置、合并、变基、切换分支等操作的历史，可用于恢复误操作和查找丢失的提交。

  

#### 2. 重置操作

```
git reset [--soft | --mixed | --hard] <commit>
```

**解释**：

- `git reset --soft <commit>` 只移动 `HEAD` 指针到 `<commit>`，暂存区和工作目录中的修改不受影响。
- `git reset --mixed <commit>`（默认）将 `HEAD` 指针和暂存区更新为 `<commit>` 的状态，工作目录不受影响。
- `git reset --hard <commit>` 会将 `HEAD` 指针、暂存区和工作目录都更新为 `<commit>` 的状态，会丢弃未提交的修改。

  

#### 3. 挑选提交

```
git cherry-pick <commit1> <commit2>...
```

**解释**：

- 从一个分支复制一个或多个特定的提交（`<commit1>`、`<commit2>` 等），并将其应用到当前分支，适合将某些特定修改引入当前分支而不合并整个分支。

#### 4、修改commit信息
- **修改最后一次提交 (Latest Commit):**
    
	`git commit --amend
    
    执行后会自动打开编辑器（如 Vim），让你修改提交信息。保存退出即可。
    
- **修改历史提交 (Older Commits):**  
    这需要使用交互式变基（interactive rebase），**非常小心**，如果提交已推送，force push 会有风险。
    
    `修改最近3次提交中的某一次
    `git rebase -i HEAD~3`
    
    在打开的编辑器中，找到你想修改的那行提交，将开头的 `pick` 改为 `reword`（或 `r`），保存退出。  
    然后 Git 会再次打开编辑器让你修改该次提交的信息，修改后保存即可。

# vim
Vim 是一个在终端里运行的、非常强大的文本编辑器。它的核心特点是**模态编辑**，这意味着在不同的“模式”下，键盘上同一个按键的功能完全不同。

## 核心三种模式
Vim 主要有三种模式，掌握它们的切换是生存的关键：

| 模式名       | 作用               | 如何进入                                  | 屏幕底部提示（如果有）    | 常用操作                           |
| --------- | ---------------- | ------------------------------------- | -------------- | ------------------------------ |
| **正常模式**  | **浏览、移动光标、执行命令** | 刚打开 Vim 时默认的模式，或从其他模式按 `ESC`          | `-- NORMAL --` | 移动光标、删除、复制、粘贴                  |
| **插入模式**  | **正常的打字、输入文本**   | 在正常模式下按 `i` (insert) 或 `a` (append) 等 | `-- INSERT --` | 就像用记事本一样输入文字                   |
| **命令行模式** | **执行保存、退出等高级命令** | 在正常模式下按 `:`                           | 在底部出现 `:` 提示符  | `:wq` (保存并退出), `:q!` (不保存强制退出) |

**模式切换心法：**

- **想打字？** 确保你在 **插入模式** （看底部是否有 `-- INSERT --`）。
    
- **打完了字想执行命令（如保存）？** 按 `ESC` 键回到 **正常模式**。
    
- **想保存或退出？** 在正常模式下按 `:` 进入 **命令行模式**，然后输入命令。


## 必备命令
### 1. 退出 Vim

场景：你打开了 Vim，可能是不小心打开的，或者写完了提交信息，现在想关闭它。

1. 首先，**按 `ESC` 键**。这确保你处于**正常模式**。（多按几次也没关系）
    
2. 然后，**按 `:`**。这时光标会跳到屏幕底部，出现一个冒号 `:`。
    
3. 在冒号后输入以下命令之一，然后按 `Enter` 执行：
    
    - **`:q`** -> **q**uit -> **退出**。**(如果文件没有修改，可以用这个)**
        
    - **`:q!`** -> **q**uit **!** -> **强制退出，不保存任何修改**。这是你的“救命稻草”，当你不想做任何更改只想退出时就用它。
        
    - **`:wq`** -> **w**rite + **q**uit -> **保存并退出**。这是写完提交信息后最常用的命令。
        
    - **`:x`** -> 和 `:wq` 效果一样，**保存并退出**。
        

**记住这个流程：`ESC` -> `:` -> `q!` 或 `wq` -> `Enter`**

### 2. 移动光标（在正常模式下）

在写 git 提交信息时，可能需要移动修改。

- **方向键**：通常可以直接用键盘的 `↑`, `↓`, `←`, `→` 键。这是最简单的方法。
    
- **`h`, `j`, `k`, `l`** (推荐习惯这个，因为所有键盘都支持):
    
    - `h` -> 左
        
    - `j` -> 下
        
    - `k` -> 上
        
    - `l` -> 右
- **按单词移动**：
    
    - `w` -> 移动到下一个**单词的开头**
        
    - `b` -> 移动到当前/上一个**单词的开头**
        
    - `e` -> 移动到当前/下一个**单词的末尾**
        
- **行内移动**：
    
    - `0` (数字零) -> 跳到**当前行的行首**
        
    - `$` -> 跳到**当前行的行尾**
        
    - `^` -> 跳到当前行**第一个非空白字符**
        
- **全文移动**：
    
    - `gg` -> 跳到**文件第一行**
        
    - `G` -> 跳到**文件最后一行**
        
    - `:[行号]` -> 跳转到指定行号（例如 `:5` 回车跳到第5行）。在交互式变基时非常有用！
        

### 3. 编辑/输入文本

- **进入插入模式开始打字**：
    
    - `i` -> **i**nsert -> 在**当前光标处**插入
        
    - `a` -> **a**ppend -> 在**当前光标后**插入
        
    - `o` -> 在当前行的**下方****新开一行**并进入插入模式 (在写多行提交信息时很好用)
        
- **删除文本** (在正常模式下)：
    
    - `x` -> 删除光标下的一个字符
        
    - `dd` -> 删除整行
- -**撤销与重做**（非常重要！）：
    
    - `u` -> **undo**，撤销上一次操作
        
    - `Ctrl + r` -> **redo**，重做被撤销的操作
        
- **复制（ Yank ）与粘贴（ Paste ）**：
    
    - `yy` -> **yank**，复制当前整行
        
    - `p` -> **paste**，在光标**下方**粘贴
        
    - `P` (大写) -> 在光标**上方**粘贴
        
- **更精准的删除**：
    
    - `dw` -> **d**elete **w**ord，删除从光标处开始到一个单词的结尾
        
    - `dd` -> 删除当前行（你已经知道了）
        
    - `d$` 或 `D` -> 删除从光标处到行尾的所有内容
        
- **进入插入模式的更多方式**：
    
    - `A` -> 直接跳到当前行的**行尾**并进入插入模式（非常常用！）
        
    - `I` -> 直接跳到当前行的**行首**并进入插入模式
        
    - `O` (大写) -> 在当前行的**上方**新开一行并进入插入模式
### 4、搜索（在正常模式下）

在解决冲突或查看代码时非常有用。

- `/` -> 进入搜索模式。输入 `/` 后接着输入你要找的词（如 `/function`），按回车。
    
- `n` -> 跳转到下一个匹配结果
    
- `N` -> 跳转到上一个匹配结果

**退出搜索状态（即取消高亮）的方法如下：**

1. **执行任何操作**：最简单的方法就是直接按 `Esc` 键（确保你回到正常模式），然后随便按 `j` 或 `k` 移动一下光标，搜索高亮通常就会消失。但最“正确”的方法是下面的命令。
    
2. **使用命令（推荐）**：在正常模式下，输入：
    
    - `:noh` -> **no** **h**ighlight 的缩写。这是最标准、最常用的命令，用于**清除搜索高亮**，但保留搜索记录。你下次按 `n` 或 `N` 还能继续跳转。
        
    - `:noh<Enter>` 执行后，令人分心的黄色高亮就消失了，但你的搜索关键词还在，可以继续用 `n` 和 `N`。
        

**总结：在正常模式下，输入 `:noh` 然后回车，即可“退出”搜索高亮状态。**
### 5、可视化模式（Visual Mode）

这是一种“先选择，后操作”的模式，非常直观。

- `v` -> 进入**字符可视化模式**，然后用移动命令（`hjkl`, `w`, `$` 等）选择文本，选好后：
    
    - 按 `d` 删除选中内容
        
    - 按 `y` 复制选中内容
        
- `V` (大写) -> 进入**行可视化模式**，直接按行选择。
    
- `Ctrl + v` -> 进入**块可视化模式**，可以进行矩形区块选择（高级功能，在修改特定列的数据时有用）。
    

**操作流程**：`v` -> 移动光标选择文本 -> 执行命令 (`d`, `y`, `:w` 等)