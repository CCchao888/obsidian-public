`mvn clean install` å’Œ `mvn install` æ˜¯ Maven æ„å»ºä¸­çš„ä¸¤ä¸ªå¸¸è§å‘½ä»¤ï¼Œå®ƒä»¬æœ‰æ˜ç¡®çš„åŒºåˆ«ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†å¯¹æ¯”ï¼š

---

### ğŸ§¹ æ ¸å¿ƒåŒºåˆ«æ€»ç»“
| **ç‰¹æ€§**             | `mvn install`                     | `mvn clean install`               |
|----------------------|----------------------------------|----------------------------------|
| **æ¸…ç†æ„å»ºè¾“å‡º**      | âŒ ä¸æ¸…ç† `target` ç›®å½•           | âœ… å…ˆæ‰§è¡Œ `clean` åˆ é™¤ `target`  |
| **æ„å»ºè¿‡ç¨‹**          | å¢é‡æ„å»ºï¼ˆå¤ç”¨å·²æœ‰ç¼–è¯‘æ–‡ä»¶ï¼‰      | å…¨æ–°æ„å»ºï¼ˆå¼ºåˆ¶ä»å¤´å¼€å§‹ï¼‰         |
| **æ„å»ºå¯é æ€§**        | å¯èƒ½å—æ—§æ–‡ä»¶å½±å“                 | é¿å…æ—§æ–‡ä»¶æ±¡æŸ“ï¼Œç»“æœæ›´å¯é        |
| **æ„å»ºæ—¶é—´**          | è¾ƒçŸ­ï¼ˆè·³è¿‡å·²ç¼–è¯‘æ–‡ä»¶ï¼‰           | è¾ƒé•¿ï¼ˆéœ€é‡æ–°ç¼–è¯‘æ‰€æœ‰ä»£ç ï¼‰       |
| **é€‚ç”¨åœºæ™¯**          | å°æ”¹åŠ¨åçš„å¿«é€Ÿæ„å»º               | é‡è¦å‘å¸ƒå‰æ„å»ºã€è§£å†³å¥‡æ€ªæ„å»ºé—®é¢˜ |

---

### ğŸ”§ æŠ€æœ¯åŸç†è¯¦è§£
#### 1. Maven ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ
Maven æ„å»ºåˆ†ä¸ºä¸‰ä¸ªç‹¬ç«‹ç”Ÿå‘½å‘¨æœŸï¼š
```mermaid
graph LR
    A[cleanç”Ÿå‘½å‘¨æœŸ] --> A1(pre-clean)
    A --> A2(clean)
    A --> A3(post-clean)
    
    B[defaultç”Ÿå‘½å‘¨æœŸ] --> B1(validate)
    B --> B2(compile)
    B --> B3(test)
    B --> B4(package)
    B --> B5(verify)
    B --> B6(install)
    B --> B7(deploy)
    
    C[siteç”Ÿå‘½å‘¨æœŸ] --> C1(site)
```

- `mvn install` â†’ **ä»…è§¦å‘ default ç”Ÿå‘½å‘¨æœŸ**ï¼Œæ‰§è¡Œåˆ° `install` é˜¶æ®µ
- `mvn clean install` â†’ **å…ˆæ‰§è¡Œ clean ç”Ÿå‘½å‘¨æœŸï¼Œå†æ‰§è¡Œ default ç”Ÿå‘½å‘¨æœŸ**

---

#### 2. æ–‡ä»¶ç³»ç»Ÿæ“ä½œå¯¹æ¯”
å‡è®¾é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š
```
my-project/
â”œâ”€â”€ src/
â”œâ”€â”€ target/  # æ„å»ºè¾“å‡ºç›®å½•
â”‚   â”œâ”€â”€ classes/
â”‚   â”œâ”€â”€ generated-sources/
â”‚   â””â”€â”€ my-app.jar
```

| **å‘½ä»¤**         | `target/` ç›®å½•å˜åŒ–               | æ•ˆæœè¯´æ˜                     |
|------------------|--------------------------------|----------------------------|
| **`mvn install`** | ä¿ç•™æ—§æ–‡ä»¶ï¼Œå¢é‡æ›´æ–°ä¿®æ”¹éƒ¨åˆ†     | å¯èƒ½æ®‹ç•™åºŸå¼ƒçš„ `.class` æ–‡ä»¶ |
| **`mvn clean install`** | 1. å…ˆåˆ é™¤æ•´ä¸ª `target/` ç›®å½•<br>2. é‡æ–°åˆ›å»ºç›®å½•å¹¶å…¨é‡ç¼–è¯‘ | å½»åº•å¹²å‡€çš„æ„å»ºç¯å¢ƒ           |

---

### âš ï¸ ä¸ºä»€ä¹ˆéœ€è¦ `clean`ï¼Ÿâ€”â€” å¸¸è§é—®é¢˜æ¡ˆä¾‹
#### åœºæ™¯ 1ï¼šç±»æ–‡ä»¶æ®‹ç•™å¯¼è‡´ NoSuchMethodError
```java
// ä¿®æ”¹å‰
public class Service {
    public void oldMethod() {...}
}

// ä¿®æ”¹åï¼ˆåˆ é™¤ oldMethodï¼‰
public class Service {
    public void newMethod() {...}
}
```
- **`mvn install` é—®é¢˜**ï¼š  
  æ—§ç‰ˆæœ¬ `Service.class` ä»å­˜åœ¨äº `target/` ä¸­ï¼Œè°ƒç”¨å¤„å°è¯•è®¿é—® `oldMethod()` å¯¼è‡´è¿è¡Œæ—¶é”™è¯¯
- **`mvn clean install` ä¿®å¤**ï¼š  
  åˆ é™¤æ—§ç±»æ–‡ä»¶ï¼Œç¡®ä¿åªå­˜åœ¨ `newMethod()`

#### åœºæ™¯ 2ï¼šèµ„æºæ–‡ä»¶æœªæ›´æ–°
```bash
# ä¿®æ”¹ src/main/resources/app.conf
echo "new_config=value" > src/main/resources/app.conf

# è¿è¡Œ mvn install
# target/classes/app.conf ä»æ˜¯æ—§ç‰ˆæœ¬ï¼
```
- **åŸå› **ï¼šMaven èµ„æºæ’ä»¶å¯èƒ½æœªæ£€æµ‹åˆ°å˜æ›´
- **è§£å†³**ï¼š`clean` å¼ºåˆ¶åˆ·æ–°èµ„æºæ–‡ä»¶

---

### ğŸš€ æ€§èƒ½ä¸å¯é æ€§æƒè¡¡
| **æŒ‡æ ‡**       | `mvn install`       | `mvn clean install` | å»ºè®®         |
|---------------|--------------------|--------------------|--------------|
| **æ„å»ºæ—¶é—´**   | â±ï¸ å¿« (çœå»æ¸…ç†å’Œå…¨é‡ç¼–è¯‘) | â±ï¸ æ…¢ (å…¨é‡é‡å»º)    | æ—¥å¸¸å¼€å‘ç”¨å¢é‡ |
| **ç»“æœå¯é æ€§** | âš ï¸ ä¸­ (å¯èƒ½å—æ—§æ–‡ä»¶å½±å“)   | âœ… é«˜ (ç»å¯¹å¹²å‡€)    | å‘å¸ƒå‰ç”¨ clean |
| **ç£ç›˜å ç”¨**   | ğŸ“¦ é«˜ (ç´¯ç§¯æ—§æ–‡ä»¶)       | ğŸ“¦ ä½ (æ¯æ¬¡æ¸…ç†)    |              |

---

### ğŸ” å¦‚ä½•éªŒè¯æ„å»ºæ˜¯å¦å¹²å‡€ï¼Ÿ
æ£€æŸ¥æ„å»ºæ—¥å¿—ä¸­çš„æ—¶é—´æˆ³ï¼š
```diff
# mvn install æ—¥å¿—ï¼ˆå¢é‡æ„å»ºï¼‰
[INFO] --- maven-compiler-plugin:3.8.1:compile (default-compile) @ my-app ---
[INFO] Nothing to compile - all classes are up to date

# mvn clean install æ—¥å¿—ï¼ˆå…¨é‡æ„å»ºï¼‰
[INFO] --- maven-clean-plugin:3.2.0:clean (default-clean) @ my-app ---
[INFO] Deleting /project/target
...
[INFO] --- maven-compiler-plugin:3.8.1:compile (default-compile) @ my-app ---
[INFO] Changes detected - recompiling the module!
```

---

### ğŸ› ï¸ æœ€ä½³å®è·µæŒ‡å—
1. **æ—¥å¸¸å¼€å‘** â†’ `mvn install`  
   ï¼ˆèŠ‚çœæ—¶é—´ï¼Œå¿«é€ŸéªŒè¯å°æ”¹åŠ¨ï¼‰
   ```bash
   # ä¿®æ”¹å•ä¸ªæ–‡ä»¶åå¿«é€Ÿæ„å»º
   mvn install
   ```

2. **é‡è¦åœºæ™¯å¿…é¡»ç”¨ clean**ï¼š
   - å‘å¸ƒç”Ÿäº§ç‰ˆæœ¬å‰
   - åˆ‡æ¢ Git åˆ†æ”¯å
   - ä¾èµ–åº“ç‰ˆæœ¬å‡çº§å
   - é‡åˆ°æ— æ³•è§£é‡Šçš„æ„å»º/è¿è¡Œæ—¶é”™è¯¯
   ```bash
   # å‘å¸ƒå‰çš„å¯é æ„å»º
   mvn clean install -DskipTests
   ```

3. **IDE é›†æˆæŠ€å·§**ï¼š  
   åœ¨ IntelliJ/Eclipse ä¸­è¿è¡Œ Maven æ—¶å‹¾é€‰ `Clean` é€‰é¡¹ï¼š  
   ![IntelliJ Maven clean é€‰é¡¹](https://example.com/maven-clean-option.png)

---

### ğŸ’¡ é«˜çº§æ›¿ä»£æ–¹æ¡ˆ
1. **éƒ¨åˆ†æ¸…ç†**ï¼ˆæ‰‹åŠ¨åˆ é™¤ç‰¹å®šæ–‡ä»¶ï¼‰ï¼š
   ```bash
   # åªæ¸…ç†ç¼–è¯‘çš„ç±»æ–‡ä»¶
   find . -name "*.class" -delete
   mvn install
   ```

2. **ä½¿ç”¨ `clean` æ’ä»¶è·³è¿‡**ï¼ˆä¸æ¨èï¼‰ï¼š
   ```xml
   <plugin>
     <artifactId>maven-clean-plugin</artifactId>
     <configuration>
       <skip>true</skip> <!-- ç¦ç”¨ clean -->
     </configuration>
   </plugin>
   ```

3. **ç»“åˆ `git clean` å½»åº•é‡ç½®**ï¼š
   ```bash
   git clean -xdf # åˆ é™¤æ‰€æœ‰æœªè·Ÿè¸ªæ–‡ä»¶ï¼ˆåŒ…æ‹¬ targetï¼‰
   mvn install
   ```

---

### âœ… ç»ˆæç»“è®º
| **å‘½ä»¤**           | æ˜¯å¦åŒ…å« clean | æ¨èåœºæ™¯                          |
|--------------------|---------------|---------------------------------|
| `mvn install`      | âŒ å¦          | æ—¥å¸¸å¼€å‘ã€å¿«é€Ÿè¿­ä»£                |
| `mvn clean install`| âœ… æ˜¯          | å‘å¸ƒæ„å»ºã€è§£å†³è¯¡å¼‚é—®é¢˜ã€ç¯å¢ƒåˆ‡æ¢æ—¶ |

> ğŸ“Œ **é»„é‡‘æ³•åˆ™**ï¼š  
> **å½“ä½ æ€€ç–‘æ„å»ºç»“æœæ—¶ï¼Œæ€»æ˜¯ä½¿ç”¨ `clean`ï¼**  
> å®ƒèƒ½è§£å†³ 90% ç”±æ®‹ç•™æ–‡ä»¶å¼•èµ·çš„â€œçµå¼‚â€æ„å»ºé—®é¢˜ã€‚


[[mavenç”Ÿå‘½å‘¨æœŸ2]]
