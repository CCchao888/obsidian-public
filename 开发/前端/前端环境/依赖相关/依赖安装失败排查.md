


# 🔍 前端依赖安装排错 Checklist

## ① 基础检查

1. **删除旧依赖重新装**
    
    ```bash
    rm -rf node_modules package-lock.json
    npm install
    ```
    
    👉 很多时候依赖冲突、缓存错误，直接清空重装最快。
    
2. **确认 Node 版本**
    
    - 看 `package.json` 或 `.nvmrc` 是否要求特定 Node 版本。
        
    - 切换：
        
        ```bash
        nvm use 16
        ```
        
    
    👉 不对版本装依赖，可能直接报错（特别是 `node-sass` 这种编译型依赖）。
    

---

## ② npm/yarn 配置检查

1. **确认 registry 正确**
    
    ```bash
    npm config get registry
    ```
    
    - 如果公司有私服，要用公司内网地址。
        
    - 不然会因为外网被墙、依赖缺失导致失败。
        
2. **清理缓存**
    
    ```bash
    npm cache clean --force
    ```
    
    👉 缓存损坏时，安装会报奇怪的错。
    

---

## ③ 看安装日志

- 安装失败一定会有提示，比如：
    
    - `node-gyp rebuild failed` → 本机缺少编译环境（Windows 要装 VS Build Tools / Python；Linux 要装 `build-essential`）。
        
    - `404 Not Found` → 依赖版本不存在，可能是 registry 设置错了。
        
    - `download binary failed` → 常见于 `node-sass`、`chromedriver`，需要科学上网或手动下载。
        

---

## ④ 关键依赖特殊处理

1. **node-sass**
    
    - 如果报下载错，可以手动指定淘宝镜像：
        
        ```bash
        npm install node-sass --sass_binary_site=https://npmmirror.com/mirrors/node-sass/
        ```
        
2. **chromedriver**
    
    - 需要和你本机 Chrome 版本对应。
        
    - 先看本机 Chrome 版本，然后装对应版本：
        
        ```bash
        npm install chromedriver@<version>
        ```
        

---

## ⑤ 项目启动验证

1. 装完后跑：
    
    ```bash
    npm run dev
    ```
    
    - 如果能跑起来，说明依赖完整。
        
2. 如果报 “找不到模块 xxx”，就说明安装缺失：
    
    - 先看 `package.json` 里是否有声明。
        
    - 没声明就 `npm install xxx --save-dev`。
        

---

## ⑥ 常用命令速查

- 强制按照 lock 文件安装（CI 常用，保证一致性）：
    
    ```bash
    npm ci
    ```
    
- 忽略安装脚本（比如临时跳过 `node-sass` 的构建）：
    
    ```bash
    npm install --ignore-scripts
    ```
    
- 查看某依赖版本：
    
    ```bash
    npm list xxx
    ```
    
- 全局依赖：
    
    ```bash
    npm list -g --depth=0
    ```
    

---

✅ 最后总结：

- **先清理 → 再检查 Node 版本 → 再看 registry → 再看日志 → 针对特定依赖处理 → 最后跑项目验证**。
    
- 这样基本 90% 的安装问题都能搞定。
    
